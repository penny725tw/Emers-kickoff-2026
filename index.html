<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emers Vietnam Invitation Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body { background-color: #f4f6f9; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .container { max-width: 600px; margin-top: 50px; background: white; padding: 40px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header { border-bottom: 2px solid #0d6efd; margin-bottom: 20px; padding-bottom: 10px; }
        .btn-generate { width: 100%; padding: 12px; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h3>Invitation Letter Generator</h3>
        <p class="text-muted">Emers Vietnam Co., Ltd [2026 Kick Off]</p>
    </div>

    <form id="inviteForm">
        <div class="mb-3">
            <label for="fullName" class="form-label">Full Name (as in Passport)</label>
            <input type="text" class="form-control" id="fullName" placeholder="e.g., JOHN DOE" required>
        </div>
        <div class="mb-3">
            <label for="passportNo" class="form-label">Passport Number</label>
            <input type="text" class="form-control" id="passportNo" placeholder="e.g., C12345678" required>
        </div>
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="issueDate" class="form-label">Issue Date</label>
                <input type="date" class="form-control" id="issueDate" required>
            </div>
            <div class="col-md-6 mb-3">
                <label for="issuePlace" class="form-label">Issue Place</label>
                <input type="text" class="form-control" id="issuePlace" placeholder="e.g., USA" required>
            </div>
        </div>
        
        <button type="button" class="btn btn-primary btn-generate" onclick="generatePDF()">Download Invitation PDF</button>
    </form>
</div>

<script>
    async function generatePDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        // --- 1. Get User Input ---
        const name = document.getElementById('fullName').value.toUpperCase();
        const pptNo = document.getElementById('passportNo').value;
        const issueDate = document.getElementById('issueDate').value;
        const issuePlace = document.getElementById('issuePlace').value;

        if(!name || !pptNo || !issueDate || !issuePlace) {
            alert("Please fill in all fields.");
            return;
        }

        // --- 2. Define Template Content (Hardcoded from your Source) ---
        // Setting font to Times to look formal
        doc.setFont("times", "normal");
        
        // Header
        doc.setFontSize(16);
        doc.setFont("times", "bold");
        doc.text("Invitation Letter", 105, 20, null, null, "center");
        
        doc.setFontSize(12);
        doc.text("Emers Vietnam Co., Ltd", 14, 35);
        doc.setFont("times", "normal");
        doc.setFontSize(10);
        doc.text("906, 9F Mapletree Business Centre, 1060 Nguyen Van Linh Street,", 14, 42);
        doc.text("Tan Phong Ward, Dist 7, HCM", 14, 47);

        // Body
        doc.setFontSize(11);
        doc.text("To whom it may concern:", 14, 60);
        
        const introText = "On behalf of Emers Vietnam Co., Ltd., we would like to invite the personnel whose details are listed below to attend a business meeting at our Ho Chi Minh City office.";
        const splitIntro = doc.splitTextToSize(introText, 180);
        doc.text(splitIntro, 14, 70);

        doc.text("Purpose of the visit: Reference to the 2026 Kick Off Meeting.", 14, 85);
        
        // User Details Section
        doc.setFont("times", "bold");
        doc.text("Personnel Details:", 14, 95);
        doc.setFont("times", "normal");
        
        doc.text(`Full name: ${name}`, 20, 105);
        doc.text(`Passport number: ${pptNo}`, 20, 112);
        doc.text(`Passport issue date: ${issueDate}`, 20, 119);
        doc.text(`Passport issue place: ${issuePlace}`, 20, 126);

        // Date and Closing
        doc.text("The event/meeting will be conducted from 24/12/2025 - 28/12/2025.", 14, 140);
        doc.text("We appreciate your interest and support to attend the event at Emers Vietnam.", 14, 150);

        doc.text("Best regards,", 14, 165);
        doc.text("On behalf of Emers Vietnam Co., Ltd.", 14, 172);
        
        // Signature Block
        doc.setFont("times", "bold");
        doc.text("Yu Yuan Kai", 14, 190);
        doc.text("Vice President", 14, 197);
        doc.setFont("times", "normal");
        doc.text("Emers Vietnam Co., Ltd", 14, 204);
        doc.text("906, 9F Mapletree Business Centre", 14, 211);
        doc.text("1060 Nguyen Van Linh Street, Tan Phong Ward, Dist 7, HCM", 14, 218);

        // --- 3. Save File ---
        doc.save(`Invitation_${name.replace(/\s+/g, '_')}.pdf`);
    }
</script>

</body>
</html>
